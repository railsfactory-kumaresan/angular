/*
 jQuery Easing v1.3: Copyright (c) 2008 George McGinley Smith | BSD License: http://www.opensource.org/licenses/bsd-license.php
 jquery.transloadit2-v2.3.2.js: Copyright (c) 2013 Transloadit Ltd | MIT License: http://www.opensource.org/licenses/mit-license.php

 Fork this on Github: http://github.com/transloadit/jquery-sdk

 Transloadit servers allow browsers to cache jquery.transloadit2.js for 1 hour.
 keep this in mind when rolling out fixes.
 json2: Douglas Crockford | Public domain
 jQuery Tools 1.2.3: Tero Piirainen | Public domain
*/
jQuery.easing.jswing=jQuery.easing.swing;
jQuery.extend(jQuery.easing,{def:"easeOutQuad",swing:function(f,a,e,c,d){return jQuery.easing[jQuery.easing.def](f,a,e,c,d)},easeInQuad:function(f,a,e,c,d){return c*(a/=d)*a+e},easeOutQuad:function(f,a,e,c,d){return-c*(a/=d)*(a-2)+e},easeInOutQuad:function(f,a,e,c,d){return 1>(a/=d/2)?c/2*a*a+e:-c/2*(--a*(a-2)-1)+e},easeInCubic:function(f,a,e,c,d){return c*(a/=d)*a*a+e},easeOutCubic:function(f,a,e,c,d){return c*((a=a/d-1)*a*a+1)+e},easeInOutCubic:function(f,a,e,c,d){return 1>(a/=d/2)?c/2*a*a*a+e:
c/2*((a-=2)*a*a+2)+e},easeInQuart:function(f,a,e,c,d){return c*(a/=d)*a*a*a+e},easeOutQuart:function(f,a,e,c,d){return-c*((a=a/d-1)*a*a*a-1)+e},easeInOutQuart:function(f,a,e,c,d){return 1>(a/=d/2)?c/2*a*a*a*a+e:-c/2*((a-=2)*a*a*a-2)+e},easeInQuint:function(f,a,e,c,d){return c*(a/=d)*a*a*a*a+e},easeOutQuint:function(f,a,e,c,d){return c*((a=a/d-1)*a*a*a*a+1)+e},easeInOutQuint:function(f,a,e,c,d){return 1>(a/=d/2)?c/2*a*a*a*a*a+e:c/2*((a-=2)*a*a*a*a+2)+e},easeInSine:function(f,a,e,c,d){return-c*Math.cos(a/
d*(Math.PI/2))+c+e},easeOutSine:function(f,a,e,c,d){return c*Math.sin(a/d*(Math.PI/2))+e},easeInOutSine:function(f,a,e,c,d){return-c/2*(Math.cos(Math.PI*a/d)-1)+e},easeInExpo:function(f,a,e,c,d){return 0==a?e:c*Math.pow(2,10*(a/d-1))+e},easeOutExpo:function(f,a,e,c,d){return a==d?e+c:c*(-Math.pow(2,-10*a/d)+1)+e},easeInOutExpo:function(f,a,e,c,d){return 0==a?e:a==d?e+c:1>(a/=d/2)?c/2*Math.pow(2,10*(a-1))+e:c/2*(-Math.pow(2,-10*--a)+2)+e},easeInCirc:function(f,a,e,c,d){return-c*(Math.sqrt(1-(a/=d)*
a)-1)+e},easeOutCirc:function(f,a,e,c,d){return c*Math.sqrt(1-(a=a/d-1)*a)+e},easeInOutCirc:function(f,a,e,c,d){return 1>(a/=d/2)?-c/2*(Math.sqrt(1-a*a)-1)+e:c/2*(Math.sqrt(1-(a-=2)*a)+1)+e},easeInElastic:function(f,a,e,c,d){f=1.70158;var k=0,h=c;if(0==a)return e;if(1==(a/=d))return e+c;k||(k=0.3*d);h<Math.abs(c)?(h=c,f=k/4):f=k/(2*Math.PI)*Math.asin(c/h);return-(h*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-f)*Math.PI/k))+e},easeOutElastic:function(f,a,e,c,d){f=1.70158;var k=0,h=c;if(0==a)return e;if(1==
(a/=d))return e+c;k||(k=0.3*d);h<Math.abs(c)?(h=c,f=k/4):f=k/(2*Math.PI)*Math.asin(c/h);return h*Math.pow(2,-10*a)*Math.sin(2*(a*d-f)*Math.PI/k)+c+e},easeInOutElastic:function(f,a,e,c,d){f=1.70158;var k=0,h=c;if(0==a)return e;if(2==(a/=d/2))return e+c;k||(k=0.3*d*1.5);h<Math.abs(c)?(h=c,f=k/4):f=k/(2*Math.PI)*Math.asin(c/h);return 1>a?-0.5*h*Math.pow(2,10*(a-=1))*Math.sin(2*(a*d-f)*Math.PI/k)+e:h*Math.pow(2,-10*(a-=1))*Math.sin(2*(a*d-f)*Math.PI/k)*0.5+c+e},easeInBack:function(f,a,e,c,d,k){void 0==
k&&(k=1.70158);return c*(a/=d)*a*((k+1)*a-k)+e},easeOutBack:function(f,a,e,c,d,k){void 0==k&&(k=1.70158);return c*((a=a/d-1)*a*((k+1)*a+k)+1)+e},easeInOutBack:function(f,a,e,c,d,k){void 0==k&&(k=1.70158);return 1>(a/=d/2)?c/2*a*a*(((k*=1.525)+1)*a-k)+e:c/2*((a-=2)*a*(((k*=1.525)+1)*a+k)+2)+e},easeInBounce:function(f,a,e,c,d){return c-jQuery.easing.easeOutBounce(f,d-a,0,c,d)+e},easeOutBounce:function(f,a,e,c,d){return(a/=d)<1/2.75?7.5625*c*a*a+e:a<2/2.75?c*(7.5625*(a-=1.5/2.75)*a+0.75)+e:a<2.5/2.75?
c*(7.5625*(a-=2.25/2.75)*a+0.9375)+e:c*(7.5625*(a-=2.625/2.75)*a+0.984375)+e},easeInOutBounce:function(f,a,e,c,d){return a<d/2?0.5*jQuery.easing.easeInBounce(f,2*a,0,c,d)+e:0.5*jQuery.easing.easeOutBounce(f,2*a-d,0,c,d)+0.5*c+e}});
(function(f){function a(){}function e(a){G=[a]}function c(a,g,h){return a&&a.apply(g.context||g,h)}function d(d){function M(a){B++||(C(),D&&(I[q]={s:[a]}),N&&(a=N.apply(d,[a])),c(J,d,[a,O,d]),c(P,d,[d,O]))}function H(a){B++||(C(),D&&a!=Q&&(I[q]=a),c(K,d,[d,a]),c(P,d,[d,a]))}d=f.extend({},R,d);var J=d.success,K=d.error,P=d.complete,N=d.dataFilter,E=d.callbackParameter,S=d.callback,Y=d.cache,D=d.pageCache,T=d.charset,q=d.url,x=d.data,U=d.timeout,F,B=0,C=a,p,z,L;V&&V(function(a){a.done(J).fail(K);J=
a.resolve;K=a.reject}).promise(d);d.abort=function(){!B++&&C()};if(!1===c(d.beforeSend,d,[d])||B)return d;q=q||g;x=x?"string"==typeof x?x:f.param(x,d.traditional):g;q+=x?(/\?/.test(q)?"&":"?")+x:g;E&&(q+=(/\?/.test(q)?"&":"?")+encodeURIComponent(E)+"=?");Y||D||(q+=(/\?/.test(q)?"&":"?")+"_"+(new Date).getTime()+"=");q=q.replace(/=\?(&|$)/,"="+S+"$1");D&&(F=I[q])?F.s?M(F.s[0]):H(F):(W[S]=e,p=f(n)[0],p.id=t+Z++,T&&(p[h]=T),X&&11.6>X.version()?(z=f(n)[0]).text="document.getElementById('"+p.id+"')."+
u+"()":p[k]=k,$&&(p.htmlFor=p.id,p.event=m),p[r]=p[u]=p[v]=function(a){if(!p[w]||!/i/.test(p[w])){try{p[m]&&p[m]()}catch(g){}a=G;G=0;a?M(a[0]):H(l)}},p.src=q,C=function(a){L&&clearTimeout(L);p[v]=p[r]=p[u]=null;A[s](p);z&&A[s](z)},A[y](p,E=A.firstChild),z&&A[y](z,E),L=0<U&&setTimeout(function(){H(Q)},U));return d}var k="async",h="charset",g="",l="error",y="insertBefore",t="_jqjsp",m="onclick",u="on"+l,r="onload",v="onreadystatechange",w="readyState",s="removeChild",n="<script>",O="success",Q="timeout",
W=window,V=f.Deferred,A=f("head")[0]||document.documentElement,I={},Z=0,G,R={callback:t,url:location.href},X=W.opera,$=!!f("<div>").html("\x3c!--[if IE]><i><![endif]--\x3e").find("i").length;d.setup=function(a){f.extend(R,a)};f.jsonp=d})(jQuery);this.JSON||(this.JSON={});
(function(){function f(a){return 10>a?"0"+a:a}function a(a){d.lastIndex=0;return d.test(a)?'"'+a.replace(d,function(a){var h=g[a];return"string"===typeof h?h:"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)})+'"':'"'+a+'"'}function e(g,d){var c,f,r,v,w=k,s,n=d[g];n&&"object"===typeof n&&"function"===typeof n.toJSON&&(n=n.toJSON(g));"function"===typeof l&&(n=l.call(d,g,n));switch(typeof n){case "string":return a(n);case "number":return isFinite(n)?String(n):"null";case "boolean":case "null":return String(n);
case "object":if(!n)return"null";k+=h;s=[];if("[object Array]"===Object.prototype.toString.apply(n)){v=n.length;for(c=0;c<v;c+=1)s[c]=e(c,n)||"null";r=0===s.length?"[]":k?"[\n"+k+s.join(",\n"+k)+"\n"+w+"]":"["+s.join(",")+"]";k=w;return r}if(l&&"object"===typeof l)for(v=l.length,c=0;c<v;c+=1)f=l[c],"string"===typeof f&&(r=e(f,n))&&s.push(a(f)+(k?": ":":")+r);else for(f in n)Object.hasOwnProperty.call(n,f)&&(r=e(f,n))&&s.push(a(f)+(k?": ":":")+r);r=0===s.length?"{}":k?"{\n"+k+s.join(",\n"+k)+"\n"+
w+"}":"{"+s.join(",")+"}";k=w;return r}}"function"!==typeof Date.prototype.toJSON&&(Date.prototype.toJSON=function(a){return isFinite(this.valueOf())?this.getUTCFullYear()+"-"+f(this.getUTCMonth()+1)+"-"+f(this.getUTCDate())+"T"+f(this.getUTCHours())+":"+f(this.getUTCMinutes())+":"+f(this.getUTCSeconds())+"Z":null},String.prototype.toJSON=Number.prototype.toJSON=Boolean.prototype.toJSON=function(a){return this.valueOf()});var c=/[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,
d=/[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g,k,h,g={"\b":"\\b","\t":"\\t","\n":"\\n","\f":"\\f","\r":"\\r",'"':'\\"',"\\":"\\\\"},l;"function"!==typeof JSON.stringify&&(JSON.stringify=function(a,g,c){var d;h=k="";if("number"===typeof c)for(d=0;d<c;d+=1)h+=" ";else"string"===typeof c&&(h=c);if((l=g)&&"function"!==typeof g&&("object"!==typeof g||"number"!==typeof g.length))throw Error("JSON.stringify");return e("",{"":a})});
"function"!==typeof JSON.parse&&(JSON.parse=function(a,g){function d(a,c){var h,f,e=a[c];if(e&&"object"===typeof e)for(h in e)Object.hasOwnProperty.call(e,h)&&(f=d(e,h),void 0!==f?e[h]=f:delete e[h]);return g.call(a,c,e)}var h;a=String(a);c.lastIndex=0;c.test(a)&&(a=a.replace(c,function(a){return"\\u"+("0000"+a.charCodeAt(0).toString(16)).slice(-4)}));if(/^[\],:{}\s]*$/.test(a.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g,"@").replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g,
"]").replace(/(?:^|:|,)(?:\s*\[)+/g,"")))return h=eval("("+a+")"),"function"===typeof g?d({"":h},""):h;throw new SyntaxError("JSON.parse");})})();
(function(f){f.tools=f.tools||{version:"2013-02-15"};var a=f.tools.expose={conf:{maskId:"exposeMask",loadSpeed:"slow",closeSpeed:"fast",zIndex:9998,opacity:0.8,startOpacity:0,color:"#fff"}},e,c,d,k,h;f.mask={load:function(g,l){if(d)return this;g=g||k;k=g=f.extend(f.extend({},a.conf),g);e=f("#"+g.maskId);e.length||(e=f("<div/>").attr("id",g.maskId),f("body").append(e));e.css({position:"fixed",top:0,left:0,width:"100%",height:"100%",display:"none",opacity:g.startOpacity,zIndex:g.zIndex,backgroundColor:g.color});
l&&l.length&&(h=l.eq(0).css("zIndex"),c=l.css({zIndex:Math.max(g.zIndex+1,"auto"==h?0:h)}));e.css({display:"block"}).fadeTo(g.loadSpeed,g.opacity);d=!0;return this},close:function(){d&&(e.fadeOut(k.closeSpeed,function(){c&&c.css({zIndex:h})}),d=!1);return this}};f.fn.mask=function(a){f.mask.load(a);return this};f.fn.expose=function(a){f.mask.load(a,this);return this}})(jQuery);
(function(){function f(a,g){var h=g||0,c=y;return c[a[h++]]+c[a[h++]]+c[a[h++]]+c[a[h++]]+"-"+c[a[h++]]+c[a[h++]]+"-"+c[a[h++]]+c[a[h++]]+"-"+c[a[h++]]+c[a[h++]]+"-"+c[a[h++]]+c[a[h++]]+c[a[h++]]+c[a[h++]]+c[a[h++]]+c[a[h++]]}function a(a,g,h){h=g&&h||0;"string"==typeof a&&(g="binary"==a?new l(16):null,a=null);a=a||{};a=a.random||(a.rng||c)();a[6]=a[6]&15|64;a[8]=a[8]&63|128;if(g)for(var d=0;16>d;d++)g[h+d]=a[d];return g||f(a)}var e=this,c;if("function"==typeof e.require)try{var d=e.require("crypto").randomBytes;
c=d&&function(){return d(16)}}catch(k){}if(!c&&e.crypto&&crypto.getRandomValues){var h=new Uint8Array(16);c=function(){crypto.getRandomValues(h);return h}}if(!c){var g=Array(16);c=function(){for(var a=0,h;16>a;a++)0===(a&3)&&(h=4294967296*Math.random()),g[a]=h>>>((a&3)<<3)&255;return g}}for(var l="function"==typeof e.Buffer?e.Buffer:Array,y=[],t={},m=0;256>m;m++)y[m]=(m+256).toString(16).substr(1),t[y[m]]=m;var m=c(),u=[m[0]|1,m[1],m[2],m[3],m[4],m[5]],r=(m[6]<<8|m[7])&16383,v=0,w=0;a.v1=function(a,
g,h){h=g&&h||0;var c=g||[];a=a||{};var d=null!=a.clockseq?a.clockseq:r,e=null!=a.msecs?a.msecs:(new Date).getTime(),l=null!=a.nsecs?a.nsecs:w+1,t=e-v+(l-w)/1E4;0>t&&null==a.clockseq&&(d=d+1&16383);(0>t||e>v)&&null==a.nsecs&&(l=0);if(1E4<=l)throw Error("uuid.v1(): Can't create more than 10M uuids/sec");v=e;w=l;r=d;e+=122192928E5;l=(1E4*(e&268435455)+l)%4294967296;c[h++]=l>>>24&255;c[h++]=l>>>16&255;c[h++]=l>>>8&255;c[h++]=l&255;e=e/4294967296*1E4&268435455;c[h++]=e>>>8&255;c[h++]=e&255;c[h++]=e>>>
24&15|16;c[h++]=e>>>16&255;c[h++]=d>>>8|128;c[h++]=d&255;a=a.node||u;for(d=0;6>d;d++)c[h+d]=a[d];return g?g:f(c)};a.v4=a;a.parse=function(a,g,h){var c=g&&h||0,d=0;g=g||[];for(a.toLowerCase().replace(/[0-9a-f]{2}/g,function(a){16>d&&(g[c+d++]=t[a])});16>d;)g[c+d++]=0;return g};a.unparse=f;a.BufferClass=l;if("function"===typeof define&&define.amd)define(function(){return a});else if("undefined"!=typeof module&&module.exports)module.exports=a;else{var s=e.uuid;a.noConflict=function(){e.uuid=s;return a};
e.transloadit_uuid=a}}).call(this);
!function(f){function a(){this.timer=this.documentTitle=this.instance=this.assemblyId=null;this._options={};this.uploads=[];this.results={};this.pollStarted=this.ended=null;this.seq=this.pollRetries=0;this.started=!1;this.params=this.assembly=null;this.lastPoll=this.bytesReceivedBefore=0;this.$modal=this.$iframe=this.$fileClones=this.$files=this.$form=this.$params=null}var e="https:"==document.location.protocol?"https://":"http://",c=e+"api2.transloadit.com/",d={service:c,assets:e+"assets.transloadit.com/",
onFileSelect:function(){},onStart:function(){},onProgress:function(){},onUpload:function(){},onResult:function(){},onCancel:function(){},onError:function(){},onSuccess:function(){},interval:2500,pollTimeout:8E3,poll404Retries:15,pollConnectionRetries:3,wait:!1,processZeroFiles:!0,triggerUploadOnFileSelection:!1,autoSubmit:!0,modal:!0,exclude:"",fields:!1,params:null,signature:null,region:"us-east-1",debug:!0},k=!1;f.fn.transloadit=function(){var h=Array.prototype.slice.call(arguments),g,c;if(0!==
this.length)if(1<this.length)this.each(function(){f.fn.transloadit.apply(f(this),h)});else{(1==h.length&&"object"==typeof h[0]||void 0===h[0])&&h.unshift("init");g=h.shift();"init"==g?(c=new a,h.unshift(this),this.data("transloadit.uploader",c)):c=this.data("transloadit.uploader");if(!c)throw Error("Element is not initialized for transloadit!");g=c[g].apply(c,h);return void 0===g?this:g}};a.prototype.init=function(a,g){this.$form=a;this.options(f.extend({},d,g||{}));var c=this;a.bind("submit.transloadit",
function(){c.validate();c.detectFileInputs();c.checkFileTypes();c._options.processZeroFiles||0!==c.$files.length?c.getBoredInstance():c.submitForm();return!1});if(this._options.triggerUploadOnFileSelection)a.on("change",'input[type="file"]',function(){a.trigger("submit.transloadit")});a.on("change",'input[type="file"]',function(){c._options.onFileSelect(f(this).val(),f(this))});this.includeCss()};a.prototype.getBoredInstance=function(){function a(){f.jsonp({url:d,timeout:g._options.pollTimeout,callbackParameter:"callback",
success:function(a){a.error?(g.ended=!0,a.url=d,g.renderError(a),g._options.onError(a)):(g.instance=a.api2_host,g.start())},error:function(f,m){if(k&&g._options.service===c&&"https://"!==e)k=!1,g._findBoredInstanceUrl(function(c,f){c?(g.ended=!0,c={error:"BORED_INSTANCE_ERROR",message:"Could not find a bored instance. "+c.message},g.renderError(c),g._options.onError(c)):(d=e+"api2."+f+"/instances/bored",a())});else{g.ended=!0;var u={error:"CONNECTION_ERROR",message:"There was a problem connecting to the upload server",
reason:"JSONP request status: "+m,url:d};g.renderError(u);g._options.onError(u)}}})}var g=this;this.instance=null;var d=this._options.service+"instances/bored",k=!0;a();this._options.modal&&this.showModal()};a.prototype._findBoredInstanceUrl=function(a){var g=this;f.ajax({url:"http://infra-"+this._options.region+".transloadit.com.s3.amazonaws.com/cached_instances.json",datatype:"json",timeout:3E3,success:function(c){c=g._shuffle(c.uploaders);g._findResponsiveInstance(c,0,a)},error:function(g,c){a(Error("Could not query S3 for cached uploaders"))}})};
a.prototype._findResponsiveInstance=function(a,g,c){if(!a[g])return c(Error("No responsive uploaders"));var d=this,k=a[g];f.jsonp({url:e+k,timeout:3E3,callbackParameter:"callback",success:function(a){c(null,k)},error:function(e,f){d._findResponsiveInstance(a,g+1,c)}})};a.prototype._shuffle=function(a){for(var g=[],c,d=0;d<a.length;d++)c=Math.floor(Math.random()*(d+1)),g[d]=g[c],g[c]=a[d];return g};a.prototype.start=function(){var a=this;this.ended=this.started=!1;this.seq=this.pollRetries=this.bytesReceivedBefore=
0;this.uploads=[];this.results={};this.assemblyId=transloadit_uuid.v1().replace(/\-/g,"");this.$fileClones=f().not(document);this.$files.each(function(){var c=f(this).clone(!0);a.$fileClones=a.$fileClones.add(c);c.insertAfter(this)});this.$iframe=f('<iframe id="transloadit-'+this.assemblyId+'" name="transloadit-'+this.assemblyId+'"/>').appendTo("body").hide();if(this._options.formData){this._options.formData.append("params",this.$form.find("input[name=params]").val());var g=new XMLHttpRequest;g.open("POST",
b);g.send(this._options.formData)}else{this.$uploadForm=f('<form enctype="multipart/form-data" />').attr("action",e+this.instance+"/assemblies/"+this.assemblyId+"?redirect=false").attr("target","transloadit-"+this.assemblyId).attr("method","POST").append(this.$files).appendTo("body").hide();var c="[name=params], [name=signature]";!0===this._options.fields?c="*":"string"===typeof this._options.fields&&(c+=", "+this._options.fields);var d=this.$form.find(":input[type!=file]").filter(c),c=d.filter("select"),
d=d.filter(function(){return!f(this).is("select")}),d=this.clone(d);this._options.params&&!this.$params&&(d=d.add('<input name="params" value=\''+JSON.stringify(this._options.params)+"'>"));this._options.signature&&(d=d.add('<input name="signature" value=\''+this._options.signature+"'>"));if("object"==typeof this._options.fields)for(g in this._options.fields)d=d.add('<input name="'+g+"\" value='"+this._options.fields[g]+"'>");d.prependTo(this.$uploadForm);c.each(function(){f('<input type="hidden"/>').attr("name",
f(this).attr("name")).attr("value",f(this).val()).prependTo(a.$uploadForm)});this.$uploadForm.submit()}this.lastPoll=+new Date;setTimeout(function(){a._poll()},300)};a.prototype.clone=function(a){var c=a.clone();a=a.filter("textarea");for(var d=c.filter("textarea"),e=0;e<a.length;++e)f(d[e]).val(f(a[e]).val());return c};a.prototype.checkFileTypes=function(){var a=this;this.$files=this.$files.filter(function(){var c=f(this).attr("accept");if(!c)return!0;/image\/jpg/g.test(c)&&!/image\/jpeg/g.test(c)&&
(c+=",image/jpeg");/image\/jpeg/g.test(c)&&!/image\/jpg/g.test(c)&&(c+=",image/jpg");-1!==c.indexOf("video/*")&&(c=c.replace(/video\/\*/g,"video/mp4,video/flv,video/avi,video/mpg,video/mov,video/wmv,video/h264,video/mkv"));-1!==c.indexOf("image/*")&&(c=c.replace(/image\/\*/g,"image/png,image/jpeg,image/gif,image/jpg,image/ico"));-1!==c.indexOf("audio/*")&&(c=c.replace(/audio\/\*/g,"audio/aac,audio/mp4,audio/mpeg,audio/ogg,audio/wav,audio/webm"));for(var c=c.split(","),d=this.value.split(".").pop().toLowerCase(),
e=0;e<c.length;e++)if(d==c[e].split("/")[1])return!0;a._options.onError({error:"INVALID_FILE_TYPE",message:"Sorry, we don't accept "+d+" files.",reason:"Invalid file selected"});return!1})};a.prototype.detectFileInputs=function(){var a=this.$form.find("input[type=file]").not(this._options.exclude);this._options.processZeroFiles||(a=a.filter(function(){return""!==this.value}));this.$files=a};a.prototype.validate=function(){if(this._options.params)this.params=this._options.params;else{var a=this.$form.find("input[name=params]");
if(!a.length){alert("Could not find input[name=params] in your form.");return}this.$params=a;try{this.params=JSON.parse(a.val())}catch(c){alert("Error: input[name=params] seems to contain invalid JSON.");return}}this.params.redirect_url?this.$form.attr("action",this.params.redirect_url):this._options.autoSubmit&&this.$form.attr("action")==this._options.service+"assemblies"&&alert("Error: input[name=params] does not include a redirect_url")};a.prototype._poll=function(a){var c=this;if(!this.ended){var d=
/(mozilla)(?:.*? rv:([\w.]+))?/.exec(navigator.userAgent),d=d&&d[1];this.documentTitle=document.title;d&&!this.documentTitle&&(document.title="Loading...");this.pollStarted=+new Date;var k=e+this.instance+"/assemblies/"+this.assemblyId+(a||"?seq="+this.seq);f.jsonp({url:k,timeout:c._options.pollTimeout,callbackParameter:"callback",success:function(a){if(!c.ended)if(c.assembly=a,"ASSEMBLY_NOT_FOUND"==a.error)c.pollRetries++,c.pollRetries>c._options.poll404Retries?(document.title=c.documentTitle,c.ended=
!0,c.renderError(a),c._options.onError(a)):setTimeout(function(){c._poll()},400);else if(a.error)c.ended=!0,c.renderError(a),document.title=c.documentTitle,c._options.onError(a);else{c.seq=a.last_seq;c.started||(c.started=!0,c._options.onStart(a));c.pollRetries=0;var d="ASSEMBLY_EXECUTING"===a.ok,e="ASSEMBLY_CANCELED"===a.ok,h="ASSEMBLY_COMPLETED"===a.ok;c._options.onProgress(a.bytes_received,a.bytes_expected,a);for(var f=0;f<a.uploads.length;f++)c._options.onUpload(a.uploads[f],a),c.uploads.push(a.uploads[f]);
for(var k in a.results)for(c.results[k]=c.results[k]||[],f=0;f<a.results[k].length;f++)c._options.onResult(k,a.results[k][f],a),c.results[k].push(a.results[k][f]);e?(c.ended=!0,document.title=c.documentTitle,c._options.onCancel(a)):(c.renderProgress(a),h||!c._options.wait&&d?(c.ended=!0,document.title=c.documentTitle,a.uploads=c.uploads,a.results=c.results,c._options.onSuccess(a),c._options.modal&&c.cancel(),c.submitForm()):(a=c.pollStarted-+new Date,c.timer=setTimeout(function(){c._poll()},a<c._options.interval?
c._options.interval:a),c.lastPoll=+new Date))}},error:function(a,d){if(!c.ended)if(c.pollRetries++,c.pollRetries>c._options.pollConnectionRetries){document.title=c.documentTitle;c.ended=!0;var e={error:"CONNECTION_ERROR",message:"There was a problem connecting to the upload server",reason:"JSONP request status: "+d,url:k};c.renderError(e);c._options.onError(e)}else setTimeout(function(){c._poll()},350)}})}};a.prototype.stop=function(){document.title=this.documentTitle;this.ended=!0};a.prototype.cancel=
function(){if(!this.ended){var a=this;this.$params&&this.$params.prependTo(this.$form);this.$fileClones.each(function(c){c=f(a.$files[c]).clone(!0);var d=f(this);c.insertAfter(d);d.remove()});clearTimeout(a.timer);this._poll("?method=delete");"Microsoft Internet Explorer"==navigator.appName&&this.$iframe[0].contentWindow.document.execCommand("Stop");setTimeout(function(){a.$iframe.remove()},500)}this._options.modal&&(f.mask.close(),this.$modal.remove())};a.prototype.submitForm=function(){null!==this.assembly&&
f("<textarea/>").attr("name","transloadit").text(JSON.stringify(this.assembly)).prependTo(this.$form).hide();this._options.autoSubmit&&this.$form.unbind("submit.transloadit").submit()};a.prototype.showModal=function(){this.$modal=f('<div id="transloadit"><div class="content"><a href="#close" class="close">Cancel</a><p class="status"></p><div class="progress progress-striped active"><div class="bar"><span class="percent"></span></div></div><label>Starting upload ...</label><p class="error"></p><div class="error-details-toggle"><a href="#">Details</a></div><p class="error-details"></p></div></div>').appendTo("body");
f.extend(this.$modal,{$content:this.$modal.find(".content"),$close:this.$modal.find(".close"),$label:this.$modal.find("label"),$progress:this.$modal.find(".progress"),$percent:this.$modal.find(".progress .percent"),$progressBar:this.$modal.find(".progress .bar"),$error:this.$modal.find(".error"),$errorDetails:this.$modal.find(".error-details"),$errorDetailsToggle:this.$modal.find(".error-details-toggle")});var a=this;this.$modal.$close.click(function(){a.cancel()});this.$modal.$error.hide();this.$modal.$errorDetails.hide();
this.$modal.$errorDetailsToggle.hide();this.$modal.expose({api:!0,maskId:"transloadit_expose",opacity:0.9,loadSpeed:250,closeOnEsc:!1,closeOnClick:!1});this.$modal.$close.click(function(){a.cancel();return!1})};a.prototype.renderError=function(a){if(this._options.modal){this.$modal.$content.addClass("content-error");this.$modal.$progress.hide();this.$modal.$label.hide();var c=a.error+": "+a.message+"<br /><br />",c=c+(a.reason||"");if(-1===["CONNECTION_ERROR","BORED_INSTANCE_ERROR","ASSEMBLY_NOT_FOUND"].indexOf(a.error))this.$modal.$error.html(c).show();
else{this.$modal.$error.html("There was an internal error.<br />Please try your upload again.").show();var d=this,k=null;f.getJSON(e+"jsonip.com/",function(a){k=a.ip}).always(function(){var t={endpoint:a.url,instance:d.instance,assembly_id:d.assemblyId,ip:k,time:d.getUTCDatetime(),agent:navigator.userAgent,poll_retries:d.pollRetries,error:c};f.post(e+"status.transloadit.com/client_error",t);var m=[],u;for(u in t)m.push(u+": "+t[u]);t="If you would like our help to troubleshoot this, please email us this information:<br /><br />";
d.$modal.$errorDetails.hide().html(t+m.join("<br />"));d.$modal.$errorDetailsToggle.show().find("a").off("click").on("click",function(a){a.preventDefault();d.$modal.$errorDetails.toggle()})})}}};a.prototype.renderProgress=function(a){if(this._options.modal){var c=a.bytes_received/a.bytes_expected*100;100<c&&(c=0);var d=a.bytes_received-this.bytesReceivedBefore,e=+new Date-this.lastPoll,f=100===c?1E3:2*this._options.interval,k="Processing files";100!=c&&(k=(a.bytes_received/1024/1024).toFixed(2)+" MB / "+
(a.bytes_expected/1024/1024).toFixed(2)+" MB ("+(d/1024/(e/1E3)).toFixed(1)+" kB / sec)");this.$modal.$label.text(k);var u=parseInt(this.$modal.$progress.css("width"),10);this.bytesReceivedBefore=a.bytes_received;if(!(0>=d)){var r=this;this.$modal.$progressBar.stop().animate({width:c+"%"},{duration:f,easing:"linear",progress:function(a,c,d){a=(100*parseInt(r.$modal.$progressBar.css("width"),10)/u).toFixed(0);100<a&&(a=100);13<a&&r.$modal.$percent.text(a+"%")}})}}};a.prototype.includeCss=function(){!k&&
this._options.modal&&(k=!0,f('<link rel="stylesheet" type="text/css" href="'+this._options.assets+'css/transloadit2-v2.3.2.css" />').appendTo("head"))};a.prototype.getUTCDatetime=function(){var a=new Date,a=new Date(a.getUTCFullYear(),a.getUTCMonth(),a.getUTCDate(),a.getUTCHours(),a.getUTCMinutes(),a.getUTCSeconds()),c=function(a){return 10>a?"0"+a:a},d=a.getTimezoneOffset(),e=(0<d?"-":"+")+c(parseInt(d/60,10));0!==d%60&&(e+=c(d%60));0===d&&(e="Z");return a.getFullYear()+"-"+c(a.getMonth()+1)+"-"+c(a.getDate())+
"T"+c(a.getHours())+":"+c(a.getMinutes())+":"+c(a.getSeconds())+e};a.prototype.options=function(a){if(0===arguments.length)return this._options;f.extend(this._options,a)};a.prototype.option=function(a,c){if(1==arguments.length)return this._options[a];this._options[a]=c}}(window.jQuery);
